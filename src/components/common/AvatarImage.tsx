import { Image } from 'react-vant';
import { useEffect, useState } from 'react';

interface AvatarImageProps {
	src: string; // 头像图片的源地址
	width?: number; // 头像的尺寸
	height?: number; // 头像的尺寸
	fit?: 'contain' | 'cover' | 'fill' | 'none' | 'scale-down'; // 图片的填充模式，默认为 'cover'
	round?: boolean; // 是否显示为圆形头像，默认为 true
	// 可以添加更多 Image 组件支持的属性，并在这里声明它们的类型
	// loadingIcon?: React.ReactNode; // 加载中的图标
	// errorIcon?: React.ReactNode;   // 加载失败的图标
	alt?: string; // 图片的替代文本
	className?: string; // 自定义 CSS 类名
	// style?: React.CSSProperties; // 自定义内联样式
}

const AvatarImage: React.FC<AvatarImageProps> = ({
	src,
	width = 100, // 提供默认值
	height = 100, // 提供默认值
	fit = 'cover', // 提供默认值
	round = false, // 提供默认值
	// loadingIcon,
	// errorIcon,
	alt,
	className,
	// style,
	...rest // 捕获并传递所有其他未明确声明的属性给 Image 组件
}) => {
	const [mounted, setMounted] = useState(false);

	useEffect(() => {
		setMounted(true);
	}, []);

	if (!mounted) return null;
	return (
		<Image
			width={width}
			height={height}
			src={src}
			fit={fit}
			round={round}
			loadingIcon={<LoadingIcon />}
			errorIcon={<ErrorIcon />}
			alt={alt || 'mmm'}
			className={className}
			// style={style}
			{...rest} // 将剩余属性传递给 Image 组件
		/>
	);
};

export default AvatarImage;

const LoadingIcon = () => (
	<svg width="66" height="66" viewBox="0 0 66 66" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ width: '100%', height: "100%" }}>
		<rect width="66" height="66" fill="#EDD0FF" />
		<path d="M32.5193 26.8123H27.5751V27.3574H27.0257V34.4441H27.5751V34.9892H32.5193V33.3538H28.6738V31.7185H32.5193V30.0831H28.6738V28.4477H32.5193V26.8123Z" fill="black" fill-opacity="0.15" />
		<path d="M49 26.8123H44.0557V27.3574H43.5064V34.4441H44.0557V34.9892H49V33.3538H45.1545V31.7185H49V30.0831H45.1545V28.4477H49V26.8123Z" fill="black" fill-opacity="0.15" />
		<path d="M34.7167 26.8123H36.9141V27.9026H37.4635V28.9928H38.0128V30.0831H38.5622V28.9928H39.1115V27.9026H39.6609V26.8123H41.8583V34.9892H40.2103V30.6282H39.6609V31.7185H39.1115V34.9892H37.4635V31.7185H36.9141V30.6282H36.3648V34.9892H34.7167V26.8123Z" fill="black" fill-opacity="0.15" />
		<path fill-rule="evenodd" clip-rule="evenodd" d="M30.8713 17H29.2232V18.0903H28.6738V19.1805H28.1245V20.2708H27.5751V21.9061H27.0258V25.1769H28.6738V22.9964H31.4206V25.1769H33.0687V21.9061H32.5193V20.2708H31.97V19.1805H31.4206V18.0903H30.8713V17ZM29.2232 21.361V20.8159H29.7725V19.7256H30.3219V20.8159H30.8713V21.361H29.2232Z" fill="black" fill-opacity="0.15" />
		<path d="M48.8627 17H43.9185V17.5451H43.3691V24.6318H43.9185V25.1769H48.8627V23.5415H45.0172V21.9061H48.8627V20.2708H45.0172V18.6354H48.8627V17Z" fill="black" fill-opacity="0.15" />
		<path d="M35.5408 17H37.1889V20.2708H37.7382V19.1805H38.2876V18.0903H38.837V17H40.485V18.6354H39.9357V19.7256H39.3863V20.8159H38.837V21.361H39.3863V22.4513H39.9357V23.5415H41.0344V25.1769H38.837V24.0867H38.2876V22.9964H37.7382V21.9061H37.1889V25.1769H35.5408V17Z" fill="black" fill-opacity="0.15" />
		<path d="M19.6094 17H17V34.9892H19.0601V20.8159H19.6094V21.9061H20.1588V34.9892H22.2189V21.9061H22.7682V20.8159H23.3176V34.9892H25.3777V17H22.7682V18.0903H22.2189V19.1805H21.6695V20.2708H20.7082V19.1805H20.1588V18.0903H19.6094V17Z" fill="black" fill-opacity="0.15" />
		<path d="M19.3344 38.045H17V49H19.3344V43.1574H20.1125V44.618H20.8907V46.0787H22.4469V47.5393H23.2251V49H25.5595V38.045H23.2251V43.8877H22.4469V42.427H21.6688V40.9664H20.1125V39.5057H19.3344V38.045Z" fill="black" fill-opacity="0.15" />
		<path fill-rule="evenodd" clip-rule="evenodd" d="M35.6752 38.045H28.672V39.5057H27.8939V47.5393H28.672V49H35.6752V47.5393H36.4534V39.5057H35.6752V38.045ZM30.2283 46.809V40.236H34.119V46.809H30.2283Z" fill="black" fill-opacity="0.15" />
		<path d="M41.1222 38.045H38.7878V46.0787H39.5659V49H41.9003V46.809H43.4566V45.3484H44.2347V46.809H45.791V49H48.1254V46.0787H48.9035V38.045H46.5691V43.8877H45.0129V38.045H42.6784V43.8877H41.1222V38.045Z" fill="black" fill-opacity="0.15" />
	</svg>
)

const ErrorIcon = () => (
	<svg width="66" height="66" viewBox="0 0 66 66" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ width: '100%', height: "100%" }}>
		<rect width="66" height="66" fill="#EDD0FF" />
		<path d="M29.0918 47H21.0036C18.7929 46.9904 17.0046 45.2041 17 43.001V23.0072C17 20.8038 18.785 19.0139 20.9957 19.0004H29.325L30.5557 21.0081H20.7618C19.7211 21.0753 18.9314 21.9701 18.9979 23.0076V40.8007L25.8021 32.5976C26.2957 31.9374 27.2332 31.8011 27.8957 32.293C28.0118 32.3791 28.115 32.482 28.2014 32.5976L32.9736 38.7204L33.9439 39.9615L33.9411 39.965L34.7125 41.4944L29.0918 47ZM45.0043 47H34.1596L38.1068 39.7768L36.2646 37.7132L39.5707 34.4035C39.719 34.216 39.9082 34.0646 40.1239 33.9607C40.3396 33.8568 40.5761 33.8032 40.8157 33.8038C40.8575 33.8038 40.8979 33.8038 40.9364 33.8085C41.1956 33.8281 41.4459 33.9108 41.6654 34.0495C41.885 34.1881 42.0669 34.3784 42.1954 34.6036L47.0021 40.7263V23.0072C46.9261 21.9391 46.0757 21.0881 45.0043 21.0077H33.0936L32.5725 19H45.0039C47.215 19.0142 49 20.8041 49 23.0072V43.0006C48.9954 45.2009 47.2118 46.9858 45.0043 47ZM37.99 31.0177C36.3232 31.0167 34.9729 29.6695 34.9739 28.0089C34.975 26.3478 36.3268 25.0021 37.9932 25.0032C39.66 25.0042 41.0104 26.3514 41.0093 28.0121C41.0091 28.4074 40.9306 28.7989 40.7785 29.164C40.6263 29.5292 40.4034 29.8609 40.1225 30.1401C39.8428 30.4192 39.5105 30.6405 39.1446 30.7911C38.7787 30.9416 38.3866 31.0186 37.9907 31.0174L37.99 31.0177Z" fill="black" fill-opacity="0.15" />
	</svg>
)